<!--#include file="inc-header2.html"-->

<div class="middle" id="middle">
  <div class="page-wrapper">
    <div class="container">
      <div class="tasks">
        <div class="ui-title">«Набор» U7-U10</div>

        <div class="tasks-info">
          <div class="tasks-info-rating">
            <span>1<img src="./images/icon-star.svg" alt=""></span>
          </div>

          <div class="tasks-info-body">
            <div class="tasks-info-content">
              <div class="tasks-info-title">Выполнено заданий</div>

              <div class="tasks-info-completed border">
                <div class="progress-bar">
                  <div class="completed-progress" id="completed-progress" style="width: 50%;">
                    <div class="completed-progress-total">10</div>
                  </div>
                  <div class="remaining-progress" id="remaining-progress" style="width: 50%;">
                    <div class="remaining-progress-total">10</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="tasks-info-content">
              <div class="tasks-info-title">Набрано баллов</div>

              <div class="tasks-info-scored border">
                <span class="red">790 <span class="total">-18</span></span> / 1000
              </div>
            </div>
          </div>

          <!-- <script>
            document.addEventListener("DOMContentLoaded", (event) => {
              // полоска заполнения выполненных\невыполненных заданий
              $(document).ready(function () {
                const totalTasks = 18;
                let completedTasks = 12;
                let remainingTasks = totalTasks - completedTasks;

                function updateProgressBar() {
                  const completedWidth = (completedTasks / totalTasks) * 100;
                  const remainingWidth = 100 - completedWidth;

                  // заполняем полоску
                  document.querySelector('.completed-progress').style.width = `${completedWidth}%`;
                  document.querySelector('.remaining-progress').style.width = `${remainingWidth}%`;

                  // добавляем текст
                  document.querySelector('.completed-progress-total').textContent = completedTasks;
                  document.querySelector('.remaining-progress-total').textContent = remainingTasks;
                }

                updateProgressBar();
              });
            });
          </script> -->
        </div>

        <div class="tasks-table">
          <div class="tasks-table-header">
            <div class="tasks-table-headline">Задание</div>
            <div class="tasks-table-headline">Срок выполнения</div>
          </div>

          <div class="tasks-table-body">
            <div class="tasks-table-item">
              <div class="tasks-table-num">1</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Родительские собрания в общеобразовательных школах, дошкольных учреждениях</a>

                <div class="tasks-table-status timer">Осталось: 20:45:43</div>
              </div>
            </div>

            <div class="tasks-table-item">
              <div class="tasks-table-num">2</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Печатные материалы</a>

                <div class="tasks-table-status" data-term="2024-08-06T11:14:00Z">
                  19.07.2024
                </div>
              </div>
            </div>

            <div class="tasks-table-item">
              <div class="tasks-table-num">2</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Печатные материалы</a>

                <div class="tasks-table-status" data-term="2024-08-06T11:15:00Z">
                  20.07.2024
                </div>
              </div>
            </div>

            <div class="tasks-table-item">
              <div class="tasks-table-num">3</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Печатные материалы</a>

                <div class="tasks-table-status" data-term="2024-08-06T15:27:00Z">
                  10.07.2024
                </div>
              </div>
            </div>

            <div class="tasks-table-item">
              <div class="tasks-table-num">4</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Печатные материалы</a>

                <div class="tasks-table-status">
                  25.07.2024
                </div>
              </div>
            </div>

            <div class="tasks-table-item green">
              <div class="tasks-table-num">5</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Открытые тренировки</a>

                <div class="tasks-table-status">Сдано</div>
              </div>
            </div>

            <div class="tasks-table-item red">
              <div class="tasks-table-num">6</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Посещение хоккейных матчей</a>

                <div class="tasks-table-status">Не сдано</div>
              </div>
            </div>

            <div class="tasks-table-item purple">
              <div class="tasks-table-num">7</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Родительские собрания в СУСУ</a>

                <div class="tasks-table-status">Связаться</div>
              </div>
            </div>

            <div class="tasks-table-item yellow">
              <div class="tasks-table-num">8</div>

              <div class="tasks-table-content">
                <a href="#" class="tasks-table-name">Посещение хоккейных матчей</a>

                <div class="tasks-table-status">Отправлено</div>
              </div>
            </div>
          </div>
        </div>
        <script>
          document.addEventListener("DOMContentLoaded", (event) => {
            $(document).ready(function() {
              function startTimer(targetDate, statusElement) {
                let timer = Math.floor(targetDate.diff(dayjs()) / 1000); // переводим миллисекунды в секунды

                const interval = setInterval(function () {
                  const hours = Math.floor(timer / 3600);
                  const minutes = Math.floor((timer % 3600) / 60);
                  const seconds = timer % 60;

                  const formattedHours = hours < 10 ? "0" + hours : hours;
                  const formattedMinutes = minutes < 10 ? "0" + minutes : minutes;
                  const formattedSeconds = seconds < 10 ? "0" + seconds : seconds;

                  $(statusElement).addClass('timer')
                  $(statusElement).text(`Осталось: ${formattedHours}:${formattedMinutes}:${formattedSeconds}`);

                  if (--timer < 0) {
                    clearInterval(interval);
                    $(statusElement).closest('.tasks-table-item').addClass('red')
                    $(statusElement).text("Не сдано");
                  }
                }, 1000);
              }

              function checkTasks() {
                $('.tasks-table-status').each(function() {
                  const targetDateAttr = $(this).data('term');

                  if (targetDateAttr) {
                    const targetDate = dayjs(targetDateAttr);
                    const now = dayjs();
                    const difference = targetDate.diff(now);

                    // Проверяем, что разница меньше или равна 24 часам
                    if (difference > 0 && difference <= 24 * 60 * 60 * 1000) {
                      if (!$(this).data('timerStarted')) {
                        startTimer(targetDate, this);
                        $(this).data('timerStarted', true); // Устанавливаем флаг, чтобы не запускать таймер повторно
                      }
                    }
                  }
                });
              }

              // Проверяем каждую секунду
              setInterval(checkTasks, 1000);
            });
          });
        </script>
      </div>
    </div>
  </div>
</div>

<!--#include file="inc-footer.html"-->